目标：大概看一下他在讲什么，做了件什么样的事情，然后有什么优缺点和就是不足，以及未来的方向，让老师方便总结。（不必精读，梳理框架逻辑。）
### 内容分析：
该论文主要讲述了针对**弗朗西斯水轮机转轮**的几何建模与计算网格生成方法，核心内容包括：
1. **参数化几何建模**：
    - 使用NURBS曲面描述转轮几何形状。
    - 方法基于给定的形状参数，全自动生成完整的转轮几何模型。
2. **计算网格生成**：
    - 自动生成基于NURBS体积的内部分网格。
    - 提高网格质量，使其适用于数值模拟。
3. **数值模拟与优化应用**：
    - 生成的网格适用于同调几何分析或有限元方法。
    - 方法可集成到基于梯度或无梯度优化算法中，进一步实现水轮机转轮的形状优化。
4. **技术细节*：
    - 解决了流面参数化和叶片轮廓曲线表示的自动化问题。
    - 提供一种高效的、自动化的设计流程。
---
将等几何分析引入水轮机领域，解决实际问题：水轮机不可压缩流体流动的数值模拟和转轮的自动形状优化

先前工作：针对轴流式水轮机
这篇文章：混流式水轮机

目标：提出一种**基于给定形状参数的NURBS曲面**的**生成几何模型**的**全自动**方法，生成**基于NURBS体积的内部零件的NURBS网格**，能直接用作数值模拟中需要的**计算网格**

---
==下面主要是两个部分的介绍： 建模 和 生成计算网格。==

输入形状参数：
![[docs/images/Pasted image 20241121141437.png]]
根据参数寻找B样条曲线来近似这些曲线，使用三次B样条
![[docs/images/Pasted image 20241121141607.png]]
基于最小二乘法近似，第一个和最后一个点插值

---
首先寻找轮转域中的**流线和流表面**，用于确定轮转叶片的轮廓。
![[docs/images/Pasted image 20241121142940.png]]
模拟轮转域中的**potential flow**，用旋转表面来识别六表面

速度场v：标量函数(速度势 velocity potential, φ)的梯度，也就是
![[docs/images/Pasted image 20241121142158.png]]
表示流体的不可压缩性（也就是提及守恒
![[docs/images/Pasted image 20241121142212.png]]
速度势需要满足域上的泊松问题
![[docs/images/Pasted image 20241121142253.png]]
求解获得速度势的等高线——也就是等势面，而流表面垂直于等势面
这里的求解域不仅包括两个旋转表面之间的域，为了边界条件还需要一些延申。青色部分是扩展，为了让流体进入轮片域的时候流动形态稳定，便于模拟。
黄色部分扩展到尾水管，确保流体离开轮片后流动的连续性。
![[docs/images/Pasted image 20241121142508.png]]

这个图上是平面，实际要再三维空间求解，把这个平面域沿涡轮轴旋转生成三维计算域。
![[docs/images/Pasted image 20241121143236.png]]

设置三维泊松问题的边界条件：入口、出口、其余边界

**入口的几何结构**：
- 入口被建模为一个以 z轴为中心的旋转圆柱 K，半径为 r。
- 在入口的每一点，速度沿指向内部的法向方向。
![[docs/images/Pasted image 20241121143711.png]]
速度势是入口速度的负值乘以圆柱半径 r。
![[docs/images/Pasted image 20241121143945.png]]

其他边界（蓝色曲线），齐次纽曼边界条件，表示流动在边界上不穿透。
![[docs/images/Pasted image 20241121144408.png]]
边界上没有法向流速
![[docs/images/Pasted image 20241121144444.png]]

---
使用三次B样条曲线来定义几何域，H(u)表示轮毂，就是轮子中间的轴承部分，R(u)表示轮环，就是内部组件和外部圈之间的这部分。
**![[docs/images/Pasted image 20241122131013.png]]
构造出来的域曲面是通过轮毂和轮环曲线之间的规则曲面生成的
![[docs/images/Pasted image 20241122131247.png]]
u方向对应轮毂和轮环的参数化，保持三次连续性，v方向实在轮毂和轮环之间插值，二次插值足够提供光滑过度。
![[docs/images/Pasted image 20241122131441.png]]
还要通过这个规则曲面生成实际的三维计算域，S绕轴旋转，表示为非均匀有理B样条NURBS
![[docs/images/Pasted image 20241122131535.png]]
Q是三维控制点，权重用来调整形状。

通过上面步骤得到了可以用来求解上面泊松问题的求解域，但是很粗糙，下一步是借助结点插入细化网格，使得细化后的网格可以通过等几何分析求解。
步骤是先细化NURBS网格，后再转化为FEM网格（这样的前后顺序可以确保几何精度）。细化后的每一个NURBS单元替换为一个六面体单元，六面体单元的角点由NURBS单元的控制点决定。

下一步是计算流线，流线描述流体再速度场中的运动路径，流体在某个点的速度唯一，因此通过这个点的流线唯一，再计算域内的每一个点，通过速度场都可以定义唯一的流线。【唯一的原理是：速度场是速度势的梯度，速度势是一个标量，所以梯度运算结果再每一点都是唯一的矢量，速度场唯一，这点的切线轨迹（流线）也就唯一】

计算流线的一组微分方程（这是固定的![[docs/images/Pasted image 20241122132514.png]]
起始点是s = (x(0), y(0), z(0))

---
接下来通过形状参数生成页面轮廓，将其映射到流面上，以实现流体力学中叶片的几何建模。
1. 在流面的参数化屏幕上构建一个平面叶片轮廓
2. 将轮廓通过保角映射映射到实际的三维流面

叶片轮廓需要两部分：
1. 弯曲线：表示叶片中轴的曲线，包括四个形状参数：相对弯度的横坐标cx,max 和 纵坐标cy,max，Leading Angle前缘角α1和 Trailing Angle后缘角α2
2. 厚度函数，定义厚度分布，在弯曲线两侧生成压力面和吸力面

使用三次b样条曲线表示弯曲线，Pi(0-6)
![[docs/images/Pasted image 20241122133200.png]]
cx,max是弯曲线的最大相对位置， 这三重节点使得弯曲线在对应控制点处P3发生尖锐变化，符合形状参数要求
![[docs/images/Pasted image 20241122133709.png]]
确保在cx,max处的C1连续条件需要使得控制点满足方程![[docs/images/Pasted image 20241122133817.png]]
根据使用的形状参数和上面这些条件，得到控制点形式为
![[docs/images/Pasted image 20241122133910.png]]
这里面的其余参数通过二阶差分的最小化来确定![[docs/images/Pasted image 20241122133949.png]]


第二步骤，构造厚度函数
 引入了三个控制参数：
相对厚度hy，控制叶片厚度的总体大小 
厚度的最大位置hx,max，表示最大厚度位置在叶片长度中的相对位置
厚度端点的偏移kh :决定叶片厚度在前缘和尾缘的过渡斜率。
![[docs/images/Pasted image 20241122134145.png]]
hy的三重节点保证曲线在hy处有较大权重，突出局部变化
hx,max的三重节点保证最大厚度在hx,max处
0，1端点对应叶片的前缘和尾缘

设置控制点的思路：Q共10个控制点
u= 0的厚度可能为0，Q0,Q1,Q2 约等于0，最大厚度点u = hx, max,  Q3\4\5约等于hy
u = 1的厚度通过偏移决定，Q6\7\8与等于kh


压力面和吸力面通过法向位移得到

叶片中心线的曲线称为弯曲线，在弯曲线上的每个采样点ti
![[docs/images/Pasted image 20241122134952.png]]
每个点ti的单位法向量定义
![[docs/images/Pasted image 20241122135038.png]]
这两个面是沿着弯曲线的法向两侧移动一个厚度hi = h(ti)形成的曲线
![[docs/images/Pasted image 20241122135133.png]]

这里称为曲线是因为，在流面的参数平面（二维的）上压力面和吸力面是曲线定义的，二维是近似说法。
而且，压力面和吸力面的二维截面在多个流面上连续分布，通过这些截面在三维空间的排列，形成叶片的三维表面。
![[docs/images/Pasted image 20241122135451.png]]


---
介绍了两个算法：
1： 构造平滑的B样条曲线逼近点集，自适应优化节点向量和控制点
2：评估和优化B样条曲线的逼近误差

![[docs/images/Pasted image 20241122140232.png]]

输入 点集Pi，容差，最大迭代次数，起点和终点的导数约束
输出 B样条曲线的控制点集Qi，节点向量T

初始化参数t0 = 0
用弦长法或者中心法，为点集pi分配参数值ti，提供曲线的初步分布信息
根据参数值、阶次r、内节点数量来计算初始节点向量T

当误差大于容差且次数未达到最大迭代次数时，使用T和Pi计算B样条曲线的控制点CP，使用CP和T计算B样条曲线的参数化表示c(t)，使用**自适应调整算法***（就是接下来的算法2），计算当前误差和需要插入的新节点，插入节点到T中，重新分布基函数

![[docs/images/Pasted image 20241122141035.png]]输入：点集Pi，参数值ti，当前的B样条曲线c(t) ,节点向量T
输出：hausdorff距离dmax表示点集和曲线之间的最大误差，需要插入的新节点的位置

提取T中的唯一节点值，形成集合S，S的大小表示节点的区间数量
计算点集pi到曲线c(t) 的最近点距离d[i]，计算dmax（所有点到曲线距离的最大值）
为每个节点区间计算误差积分，估算该区间的总误差——找到误差最大区间，在最大误差区间的两个节点之间插入一个新的节点，位置是两端节点的中点


把叶片和流面方程求解交点，再将计算的平面轮廓映射到流面，最终得到叶片的三维空间轮廓。至此，就完成了论文的主要工作，基于形状参数进行几何建模。


---
![[docs/images/Pasted image 20241122141919.png]]



下一个部分的核心目标是：生成高质量的计算网格，使其可以直接用于等几何分析或者转化为有限元分析所需的六面体网格
![[docs/images/Pasted image 20241122142210.png]]
轮转是一个旋转对称结构，涡轮中的流体在每个叶片之间流动的情况相似，
需要对流体的流动空间进行建模，通道指的是涡轮机中相邻叶片之间的流动区域，因为相似，只需要构造两个叶片之间的单一通道。
通道的形状由叶片表面决定，压力面和吸力面，每个流面上，通道可以看作二维平面区域。三维上，通道通过多个流面叠加而成，形成整个流体流动空间。![[docs/images/Pasted image 20241122143304.png]]
![[docs/images/Pasted image 20241122143322.png]]
从平面叶片通道生成三维几何体，最终用于生成计算网格并用于流体模拟。
- **映射到流面**：
    - 将平面通道的多块 B 样条表示（包括三个区域：黄色、红色、紫色）映射到流面 S(u,v)S(u, v)S(u,v)，通过其参数化完成。
    - 映射时，对每个平面通道区域进行密集采样，确保几何精度。
- **生成空间叶片通道**：
    - 映射后的通道区域在三维流面上形成空间几何形状，即**空间叶片通道**。
    
 **1.2 多块 B 样条表示的要求**
- **连续性要求**：
    - 不同区域之间必须满足 C0连续性（即几何上的连接性）。
    - 第一块（黄色）和第二块（红色），第二块（红色）和第三块（紫色）的连接满足 C0 连续。
- **特殊处理的边界**：
    - 对于红色区域（叶片部分）的两侧边界（对应压力面和吸力面），它们已经通过前面方法（例如公式 (23)）生成，不再重复近似。
    - 已知的控制点直接应用到结果控制网格中。
- ![[docs/images/Pasted image 20241122144349.png]]
- 左图就表示了所选流表面上的空间叶片通道、空间叶片轮廓的压力侧和吸力侧（红色、蓝色）以及叶片的前缘和后缘的多面片B样条表示（绿色、棕色）
### **从空间叶片通道到三维体积模型**

#### **2.1 Loft 方法生成体积模型**

- **Loft 方法**：
    
    - Loft 是一种从一系列曲面生成体积的技术。
    - 通过插值多个流面上的叶片通道，生成三维体积模型，表示转轮的内区域及部分导流管。
![[docs/images/Pasted image 20241122144550.png]]
![[docs/images/Pasted image 20241122144608.png]]

总的来说：
- 通过平面通道映射到流面，生成了多块 B 样条描述的三维叶片通道。
- 使用 Loft 方法将多个通道连接，构造了整个叶片和导流管的体积模型。
- 通过 Jacobian 和缩放 Jacobian 确保网格适合用于数值模拟。